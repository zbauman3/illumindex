import { CommandBitmap } from "./commands";

export type Bitmap = Pick<CommandBitmap, 'size' | 'data'>

export const createEmptyBitmap = (width: number, height: number): Bitmap => {
  return {
    size: {
      width,
      height,
    },
    data: new Array(width * height).fill(0)
  }
}

export const mergeBitmaps = ({
  base,
  overlay,
  offsetX,
  offsetY,
}: {
  base: Bitmap,
  overlay: Bitmap,
  offsetX: number,
  offsetY: number
}): Bitmap => {
  const data = [...base.data];
  for (let y = 0; y < overlay.size.height; y++) {
    for (let x = 0; x < overlay.size.width; x++) {
      const baseIndex = (y + offsetY) * base.size.width + (x + offsetX);
      const overlayIndex = y * overlay.size.width + x;

      if (overlay.data[overlayIndex] !== 0) {
        data[baseIndex] = overlay.data[overlayIndex];
      }
    }
  }

  return {
    size: base.size,
    data
  };
};

export const sun: Bitmap = {
  size: {
    height: 30,
    width: 30,
  },
  data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 0, 0, 0, 0, 0, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 0, 0, 0, 0, 0, 0, 0, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 0, 0, 0, 0, 0, 0, 0, 65152, 65152, 0, 0, 0, 0, 0, 0, 0, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 65152, 65152, 65152, 65152, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 0, 0, 0, 0, 0, 0, 0, 65152, 65152, 65152, 65152, 0, 0, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 0, 0, 65152, 65152, 65152, 65152, 0, 0, 0, 0, 0, 0, 0, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 65152, 65152, 65152, 65152, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 0, 0, 0, 0, 0, 0, 0, 65152, 65152, 0, 0, 0, 0, 0, 0, 0, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 0, 0, 0, 0, 0, 0, 0, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 0, 0, 0, 0, 0, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65152, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
}